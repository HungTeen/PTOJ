(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4b10e546"],{"25a6":function(t,n,e){"use strict";e("60f3")},"60f3":function(t,n,e){},bb3e:function(t,n,e){"use strict";e.r(n),e("d3b7");var i=e("5530"),o=e("3228"),a=e("7aa9"),s=e("5880");i={name:"announcement",components:{Editor:function(){return Promise.resolve().then(e.bind(null,"a956"))}},data:function(){return{contestID:"",showEditAnnouncementDialog:!1,announcementList:[],pageSize:15,total:0,mode:"create",announcement:{id:null,title:"",content:"",status:0,uid:""},announcementDialogTitle:"Edit Announcement",loading:!1,currentPage:0}},mounted:function(){this.init()},methods:{init:function(){this.contestID=this.$route.params.contestId,this.contestID?this.getContestAnnouncementList(1):this.getAnnouncementList(1)},currentChange:function(t){this.currentPage=t,this.contestID?this.getContestAnnouncementList(t):this.getAnnouncementList(t)},getAnnouncementList:function(t){var n=this;this.loading=!0,o.a.admin_getAnnouncementList(t,this.pageSize).then((function(t){n.loading=!1,n.total=t.data.data.total,n.announcementList=t.data.data.records}),(function(t){n.loading=!1}))},getContestAnnouncementList:function(t){var n=this;this.loading=!0,o.a.admin_getContestAnnouncementList(this.contestID,t,this.pageSize).then((function(t){n.loading=!1,n.total=t.data.data.total,n.announcementList=t.data.data.records})).catch((function(){n.loading=!1}))},onOpenEditDialog:function(){setTimeout((function(){var t;document.createEvent?((t=document.createEvent("HTMLEvents")).initEvent("resize",!0,!0),window.dispatchEvent(t)):document.createEventObject&&window.fireEvent("onresize")}),0)},submitAnnouncement:function(){var t,n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,i="";e.id||(e=this.announcement),this.contestID?(t={announcement:e,cid:this.contestID},i="edit"===this.mode?"admin_updateContestAnnouncement":"admin_createContestAnnouncement"):(i="edit"===this.mode?"admin_updateAnnouncement":"admin_createAnnouncement",t=e),o.a[i](t).then((function(t){n.showEditAnnouncementDialog=!1,a.a.success(n.$i18n.t("m.Post_successfully")),n.init()})).catch()},deleteAnnouncement:function(t){var n=this;this.$confirm(this.$i18n.t("m.Delete_Announcement_Tips"),"Warning",{confirmButtonText:this.$i18n.t("m.OK"),cancelButtonText:this.$i18n.t("m.Cancel"),type:"warning"}).then((function(){n.loading=!0;var e=n.contestID?"admin_deleteContestAnnouncement":"admin_deleteAnnouncement";o.a[e](t).then((function(t){n.loading=!0,a.a.success(n.$i18n.t("m.Delete_successfully")),n.init()}))})).catch((function(){n.loading=!1}))},openAnnouncementDialog:function(t){this.showEditAnnouncementDialog=!0,null!==t?(this.announcementDialogTitle=this.$i18n.t("m.Edit_Announcement"),this.announcement=Object.assign({},t),this.mode="edit"):(this.announcementDialogTitle=this.$i18n.t("m.Create_Announcement"),this.announcement.title="",this.announcement.status=0,this.announcement.content="",this.announcement.uid=this.userInfo.uid,this.announcement.username=this.userInfo.username,this.mode="create")},handleVisibleSwitch:function(t){this.mode="edit",this.submitAnnouncement({id:t.id,title:t.title,content:t.content,status:t.status,uid:t.uid})}},watch:{$route:function(){this.init()}},computed:Object(i.a)({},Object(s.mapGetters)(["userInfo"]))},e("25a6"),s=e("2877"),i=Object(s.a)(i,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("el-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"panel-title home-title"},[t._v(t._s(t.$t("m.General_Announcement")))])]),e("div",{staticClass:"create"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(n){return t.openAnnouncementDialog(null)}}},[t._v(t._s(t.$t("m.Create")))])],1),e("div",{staticClass:"list"},[e("vxe-table",{ref:"table",attrs:{loading:t.loading,data:t.announcementList,"auto-resize":"",stripe:""}},[e("vxe-table-column",{attrs:{"min-width":"50",field:"id",title:"ID"}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"title","show-overflow":"",title:t.$t("m.Announcement_Title")}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtCreate",title:t.$t("m.Created_Time")},scopedSlots:t._u([{key:"default",fn:function(n){return n=n.row,[t._v(" "+t._s(t._f("localtime")(n.gmtCreate))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtModified",title:t.$t("m.Modified_Time")},scopedSlots:t._u([{key:"default",fn:function(n){return n=n.row,[t._v(" "+t._s(t._f("localtime")(n.gmtModified))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",field:"username","show-overflow":"",title:t.$t("m.Author")}}),e("vxe-table-column",{attrs:{"min-width":"100",field:"status",title:t.$t("m.Announcement_visible")},scopedSlots:t._u([{key:"default",fn:function(n){var i=n.row;return[e("el-switch",{attrs:{"active-text":"","inactive-text":"","active-value":0,"inactive-value":1},on:{change:function(n){return t.handleVisibleSwitch(i)}},model:{value:i.status,callback:function(n){t.$set(i,"status",n)},expression:"row.status"}})]}}])}),e("vxe-table-column",{attrs:{title:"Option","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.Edit_Announcement"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-edit-outline",size:"mini",type:"primary"},nativeOn:{click:function(e){return t.openAnnouncementDialog(n.row)}}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.Delete_Announcement"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-delete-solid",size:"mini",type:"danger"},nativeOn:{click:function(e){return t.deleteAnnouncement(n.row.id)}}})],1)]}}])})],1),e("div",{staticClass:"panel-options"},[t.contestID?t._e():e("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.currentChange}})],1)],1)]),e("el-dialog",{attrs:{title:t.announcementDialogTitle,visible:t.showEditAnnouncementDialog,fullscreen:!0},on:{"update:visible":function(n){t.showEditAnnouncementDialog=n},open:t.onOpenEditDialog}},[e("el-form",{attrs:{"label-position":"top",model:t.announcement}},[e("el-form-item",{attrs:{label:t.$t("m.Announcement_Title"),required:""}},[e("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Announcement_Title")},model:{value:t.announcement.title,callback:function(n){t.$set(t.announcement,"title",n)},expression:"announcement.title"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Announcement_Content"),required:""}},[e("Editor",{attrs:{value:t.announcement.content},on:{"update:value":function(n){return t.$set(t.announcement,"content",n)}}})],1),e("div",{staticClass:"visible-box"},[e("span",[t._v(t._s(t.$t("m.Announcement_visible")))]),e("el-switch",{attrs:{"active-value":0,"inactive-value":1,"active-text":"","inactive-text":""},model:{value:t.announcement.status,callback:function(n){t.$set(t.announcement,"status",n)},expression:"announcement.status"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"danger"},nativeOn:{click:function(n){t.showEditAnnouncementDialog=!1}}},[t._v(t._s(t.$t("m.Cancel")))]),e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.submitAnnouncement(n)}}},[t._v(t._s(t.$t("m.OK")))])],1)],1)],1)}),[],!1,null,"15edcee0",null);n.default=i.exports}}]);